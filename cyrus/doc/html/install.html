<HTML>
<HEAD>
<TITLE>Installing and Configuring the Cyrus IMAP Server</TITLE>
<!-- Changed by: John Gardiner Myers, 14-Nov-1995 -->
</HEAD>
<BODY>
<h1>           Installing and Configuring the Cyrus IMAP Server</h1>

<P>The Internet Message Access Protocol (IMAP) is an Internet
standards-track protocol for accessing messages (mail, news, etc).
The IMAP server stores and provides access to messages.

<P>A list of answers to common installation problems is maintained in 
<A HREF="http://andrew2.andrew.cmu.edu/cyrus/imapd/install-FAQ">http://andrew2.andrew.cmu.edu/cyrus/imapd/install-FAQ</A>.

<P>Feedback on the software or on the document may be sent to
"<tt>cyrus-bugs@andrew.cmu.edu</tt>".  The
<tt>info-cyrus@andrew.cmu.edu</tt> mailing list exists for the
discussion of this server and other Cyrus software.  Send mail to
<TT>info-cyrus-request@andrew.cmu.edu</TT> to subscribe.

<P><B>IMPORTANT:</B> Upgrading from the Cyrus IMAP server version 1.3
or earlier requires running "<TT>reconstruct -m</TT>" after installing
this version of the software.  See the file <a
HREF="changes.html"><TT>doc/changes</TT></a> in the distribution for more
information.

<H2>Prerequisites and other notes</H2>

<P>The following programs and/or packages are required:

<ul>

<LI> makedepend.  A version is included in the <TT>makedepend</TT>
subdirectory of the distribution.  If all else fails, make a shell
script that does nothing, call it "<TT>makedepend</TT>", and make sure
you always give the command "<TT>make clean</TT>" before "<TT>make
all</TT>".

<LI> Tcl, version 7.4 or later.  To obtain Tcl, see the <A
HREF="ftp://rtfm.mit.edu/pub/usenet/comp.lang.tcl"><TT>comp.lang.tcl</TT>
FAQ</A>

<LI> If compiling with Kerberos support, the installed Kerberos must
include the DES library.  Some vendor distributions of Kerberos,
including the one with Solaris, do not have this support and cannot be
used.  Sites in the USA and Canada may obtain Kerberos by following
the instructions in <A
HREF="ftp://athena-dist.mit.edu/pub/kerberos/README.KRB4">ftp://athena-dist.mit.edu/pub/kerberos/README.KRB4</A>.
The author is unable to assist other sites in obtaining Kerberos.

<LI> It is recommended that sites install Sendmail version 8.7.1 or later.  Sendmail distributions may
be obtained from
<A HREF="ftp://ftp.cs.berkeley.edu/ucb/sendmail">ftp://ftp.cs.berkely.edu/ucb/sendmail</A>

</ul>
<H2>Compiling the IMAP Server</H2>

Once you have unpacked the files (see the <A
HREF="readme.html"><TT>README</TT></A> file for more information),
"<TT>cd</TT>" to the "<tt>imapd-1.4</tt>" directory (This document
assumes that the version number is 1.4.). The configuration files and
various subdirectories are stored there.  In the directory that the
<TT>configure</TT> file is in, type "<kbd>./configure</kbd>" to
configure the software.

<P>The "<TT>configure</TT>" shell script attempts to guess correct
values for various system-dependent variables used during compilation.
It uses those values to create a "<TT>Makefile</TT>" in each directory
of the package.  Finally, it creates a shell script
"<TT>config.status</TT>" that you can run in the future to recreate
the current configuration, a file "<TT>config.cache</TT>" that saves
the results of its tests to speed up reconfiguring, and a file
"<TT>config.log</TT>" containing compiler output (useful mainly for
debugging "<TT>configure</TT>").

<P>Running "<tt>configure</tt>" takes awhile.  While running, it
prints some messages telling which features it is checking for.

<P>You can compile the package in a different directory from the one
containing the source code.  Doing so allows you to compile it on more
than one kind of computer at the same time.  To do this, you must use
a version of "<TT>make</TT>" that supports the "<tt>VPATH</tt>"
variable, such as GNU "<TT>make</TT>".  "<TT>cd</TT>" to the directory
where you want the object files and executables to go and run the
"<tt>configure</tt>" script.  "<tt>configure</tt>" automatically
checks for the source code in the directory that "<tt>configure</tt>"
is in and in "<tt>..</tt>".

<P>By default, "<TT>make install</TT>" will install files (other than
server-specific programs) in "<TT>/usr/local/bin</TT>",
"<TT>/usr/local/man</TT>", etc.  You can specify an installation
prefix other than "<TT>/usr/local</TT>" by giving "<TT>configure</TT>"
the option "<TT>--prefix=PATH</TT>".

<P>You can specify separate installation prefixes for
architecture-specific files and architecture-independent files.  If
you give "<TT>configure</TT>" the option
"<TT>--exec-prefix=PATH</TT>", the package will use <TT>PATH</TT> as
the prefix for installing programs and libraries.  Documentation and
other data files will still use the regular prefix.

<P>By default, "<TT>make install</TT>" will install the
server-specific programs in "<TT>/usr/cyrus/bin</TT>".  You can
specify a server-specific installation prefix other than
"<TT>/usr/cyrus</TT>" by giving "<TT>configure</TT>" the option
"<TT>--with-cyrus-prefix=PATH</TT>".

<p>Here are a list of switches that can be used with "<A
NAME="configure"><tt>configure</tt></A>".

<dl>
<dt><tt>--cache-file=FILE</tt>
<dd>Save the results of the tests in FILE instead of "<tt>config.cache</tt>".
Set FILE to "<tt>/dev/null</tt>" to disable caching, for debugging
"<tt>configure</tt>". <P>

<dt><tt>--help</tt>
<dd>Print a summary of the options to "<tt>configure</tt>", and exit. <P>

<dt><tt>--quiet</tt>
<dt><tt>--silent</tt>
<dt><tt>-q</tt>
<dd>Do not print messages saying which checks are being made. <P>

<dt><tt>--srcdir=DIR</tt>
<dd>Look for the package's source code in directory DIR.  Usually
"<tt>configure</tt>" can determine that directory automatically. <P>

<dt><tt>--version</tt>
<dd>Print the version of Autoconf used to generate the "<tt>configure</tt>"
script, and exit. <P>

<dt><tt>--with-cyrus-user=USER</tt>
<dd>Specifies the userid used for installing setuid programs.  By default,
configure uses "<TT>cyrus</TT>". <P>

<dt><tt>--with-news-group=GROUP</tt> 
<dd>Specifies the group used for
installing the program "<TT>rmnews</TT>".  By default, configure uses
"<TT>news</TT>". <P>

<dt><tt>--with-login=METHOD</tt>
<dd>Specifies the login authentication module to use.  Currently
implemented authentication modules are:

<dl compact>

<DT><TT>unix</TT>
<DD>Unix <tt>/etc/passwd</tt> file
<DT><TT>unix_getspnam</TT>
<DD>Unix shadow <tt>passwd</tt> file, accessed through getspnam()
<DT><TT>krb</TT>
<DD>Kerberos version 4

</dl>

By default, configure uses "<tt>krb</tt>" if the file <TT>/etc/krb.conf</TT>
exists, "<tt>unix</tt>" otherwise. <P>

<dt><tt>--with-auth=METHOD</tt>
<dd>Specifies the authorization module to use.  Currently implemented
authorization modules are:

<dl compact> 

<DT><tt>unix</tt>
<DD>Unix <tt>/etc/passwd</tt> and <tt>/etc/group</tt> file

<DT><tt>krb</tt>
<DD>Kerberos principals 

</dl>

The selected authorization module must be compatible with the 
login module.  By default, uses the authorization module with 
the same name as the selected login module. <P>

<dt><tt>--with-notify=METHOD</tt>
<dt><tt>--without-notify</tt>
<dd>Specifies the new mail notification method to use.
Currently implemented notification methods are:

<dl compact> 

<DT><tt>zephyr</tt>
<DD>New mail notification through Zephyr

<DT><tt>no</tt>
<DD>No new mail notification

</dl>

By default, uses "<TT>zephyr</TT>" if the Zephyr libraries are available, 
otherwise "<TT>no</TT>".<P>

<dt><tt>--with-inn=PATH</tt>
<dd>Specifies the location of INN's <TT>NEWSLIB</TT> directory.  By
default, looks for INN in a few common places.  It is not necessary
for "<tt>configure</tt>" to find INN. <P>

<dt><tt>--with-krb=PATH</tt>
<dt><tt>--without-krb</tt>
<dd>Specifies the path to the Kerberos v4 libraries and header files 
(optional).  By default, looks in "<tt>/usr/local</tt>" and then in the 
compiler's default link path.

<P><B>IMPORTANT:</B> The Kerberos v4 support requires the DES library,
even if the "<TT>--disable-privacy</TT>" configure option is given.
Some vendor distributions of Kerberos, including the one with Solaris,
do not have this support and cannot be used.

<p>Either "<tt>--without-krb</tt>" or "<tt>--with-krb=no</tt>" prevents
Kerberos v4 support from being compiled in. <P>

<dt><tt>--with-tcl=PATH</tt>
<dt><tt>--without-tcl</tt>
<dd>Specifies the path to the Tcl (version 7.4 or later) library and header file (optional).
By default, looks in "<tt>/usr/local</tt>" and then in the compiler's
default link path.  The Tcl library is necessary to compile
"<tt>cyradm</tt>", the administrative client.  <P>

<dt><tt>--with-zephyr=PATH</tt>
<dt><tt>--without-zephyr</tt>
<dd>Specifies the path to the Zephyr library and header file
(optional).  By default, looks in "<tt>/usr/local</tt>" and then in
the compiler's default link path.  The Zephyr library is optional, if
found it may be used to notify users of new mail.<P>

<dt><tt>--with-lock=METHOD</tt>
<dd>Specifies the locking method to use.  Currently implemented locking
methods are:

<DL compact>

<DT><TT>flock</TT>
<DD><TT>flock()</TT> locking
<DT><TT>fcntl</TT>
<DD><TT>fcntl()</TT> locking
</DL>

By default, uses "<tt>flock</tt>" if the "<tt>flock()</tt>"
function exists, "<tt>fcntl</tt>" otherwise. <P>

<dt><tt>--disable-cyradm</tt>
<dd>Do not compile the <TT>cyradm</TT> administrative client.<P>

<dt><tt>--disable-privacy</tt>
<dd>Disables all network privacy support.  Use this if you do not have
the appropriate routines in the authentication libraries (for example,
<TT>krb_rd_priv()</TT> and <TT>krb_mk_priv()</TT> for Kerberos v4) or
are compiling binaries subject to export control restrictions. <P>

<dt><tt>--enable-amssync</tt>
<dd>Include AMS (Andrew Message System) to IMAP bboard synchronization
support.  Requires the AMS libraries. <P>

<dt><tt>--enable-cmulocal</tt>
<dd>Include Carnegie Mellon's internal support features.
</dl>

"<tt>configure</tt>" ignores any other arguments that you give it.

<P>Some systems require unusual options for compilation or linking
that the "<TT>configure</TT>" script does not know about.  You can
give "<TT>configure</TT>" initial values for variables by setting them
in the environment.  Using a Bourne-compatible shell, you can do that
on the command line like this:

<pre>
   CC=c89 CFLAGS=-O2 LIBS=-lposix ./configure
</pre>

Or on systems that have the "<TT>env</TT>" program, you can do it like this:

<pre>
   env CPPFLAGS=-I/usr/local/include LDFLAGS=-s ./configure
</pre>

The "<tt>make</tt>" variables that you might want to override with
environment variables when running "<tt>configure</tt>" are:

<DL compact>
<DT><TT>CC</TT>
<DD>C compiler program.<br>
Default is "<tt>cc</tt>", or "<tt>gcc</tt>" if "<tt>gcc</tt>" is in your <tt>PATH</tt>.<br>
(For "<tt>CC</tt>", any value given in the environment <strong>overrides</strong> the
value that "<tt>configure</tt>" would choose.)

<DT><TT>CFLAGS</TT>
<DD>Debugging and optimization options for the C compiler.<br>

<DT><TT>CPPFLAGS</TT>
<DD>Header file search directory ("<tt>-IDIR</tt>") and any other
miscellaneous options for the C preprocessor and compiler.  If it is
not set in the environment when "<tt>configure</tt>" runs, the default value is
empty.<br>

<DT><TT>LDFLAGS</TT>
<DD>Stripping ("<TT>-s</TT>") and any other miscellaneous options for the
linker.  If it is not set in the environment when "<tt>configure</tt>" runs,
the default value is empty. 

<DT><TT>DEFS</TT>
<DD>Configuration options, in the form "<tt>-Dfoo -Dbar ...</tt>"<br>

<DT><TT>LIBS</TT>
<DD>Libraries to link with, in the form "<tt>-lfoo -lbar ...</tt>"<br>
(For "<tt>DEFS</tt>" and "<tt>LIBS</tt>", any value given in the
environment is <strong>added</strong> to the value that
"<tt>configure</tt>" chooses.)
</DL>

If you need to do unusual things to compile the package, we encourage
you to figure out how "<tt>configure</tt>" could check whether to do them, and
mail diffs or instructions to "<tt>cyrus-bugs@andrew.cmu.edu</tt>" so we
can include them in the next release.

<p>The file "<tt>configure.in</tt>" is used as a template to create 
"<tt>configure</tt>" by
a program called "<tt>autoconf</tt>".  You will only need it if you want to
regenerate "<tt>configure</tt>" using a newer version of "<tt>autoconf</tt>".

<p>Once you have successfully run "<tt>configure</tt>", execute the
following commands:

<pre>
<kbd>   make depend
   make all CFLAGS=-O
</kbd></pre>

If you want, you can override the "<tt>make</tt>" variables
<tt>CFLAGS</tt> and <tt>LDFLAGS</tt> by entering the following:

<pre>
<kbd>   make all CFLAGS=-O2 LDFLAGS=-s
</kbd></pre>

<h2>Configuring the IMAP Server</h2>

This section describes the shell scripts to run and the configuration 
files to modify once "<tt>configure</tt>" and "<tt>make</tt>" have run.

<ol> <li>Create a user and group for the Cyrus subsystem.  The
examples in this document assume a user of "<tt>cyrus</tt>" and a
group of "<tt>mail</tt>", though any user and group name can be used.
If a user other than "<tt>cyrus</tt>" is to be used, it must have been
previously specified in the "<TT>--with-cyrus-user=</TT>" option to
"<TT>configure</TT>".
 <P>

<li>After you've logged in as "<TT>root</TT>", install the cyrus software.

<pre>
<kbd>   make install
</kbd></pre>

<li>The Cyrus IMAP server uses the 4.3BSD syslog that separates
messages into both levels and categories.  Invoke "<kbd>man
syslog</kbd>" to see if "<tt>openlog()</tt>" takes three arguments. If
it does not, replace the system "<tt>syslogd</tt>" and
"<tt>syslog.conf</tt>" with the files provided in the <A
NAME="syslog"><tt>imapd-1.4/syslog</tt></A> directory.

<pre>
<kbd>   mv syslogd /etc/syslogd
   mv syslog.conf /etc/syslog.conf
</kbd></pre>

If you do not copy the "<tt>syslog.conf</tt>" file in 
"<TT>imapd-1.4/syslog</TT>" to the 
"<tt>/etc</tt>" directory, be sure to add support for
"<tt>local6.debug</tt>".  The file should include a line like:

<pre>
   local6.debug  /var/adm/imapd.log
</pre>

Create the <TT>imapd.log</TT> file:

<pre>
<kbd>   touch /var/adm/imapd.log
</kbd></pre>

<li>Create the file "<tt>/etc/imapd.conf</tt>". Here is a sample
"<tt>imapd.conf</tt>" with a minimal number of values defined:

<pre>
   configdirectory: /var/imap
   partition-default: /var/spool/imap
   admins: curtj abell
   srvtab: /var/imap/srvtab
</pre>

For a description of all the fields in this file, see the <A
HREF="imapd.conf.5.html"><tt>imapd.conf</tt>(5)</A> man page.
 <P>

<li>Create the configuration directory specified by the
"<tt>configdirectory</tt>" option in "<tt>imapd.conf.</tt>" The
configuration directory is similar in concept to the
"<tt>/usr/lib/news</tt>" directory.  It stores information about the
IMAP server as a whole.

<p>This document uses the configuration directory "<tt>/var/imap</tt>"
in its examples.  This directory should be owned by the
cyrus user and group and should not permit access to other users.

<pre>
<kbd>   cd /var
   mkdir imap
   chown cyrus imap
   chgrp mail imap
   chmod 750 imap
</kbd></pre>

<li>In the configuration directory, create the empty file "<tt>mailboxes</tt>"
and a set of empty directories:

<pre>
<kbd>   cd imap
   true &gt;&gt; mailboxes
   mkdir user quota proc log
   chown cyrus *
   chgrp mail *
</kbd></pre>

<li>Create the default partition directory specified in the
"<tt>/etc/imapd.conf</tt>" file.

<p>This document uses a default partition directory of 
"<tt>/var/spool/imap</tt>" in the following example:

<pre>
<kbd>   cd /var/spool
   mkdir imap
   chown cyrus imap
   chgrp mail imap
   chmod 750 imap
</kbd></pre>

The partition directory is similar in concept to
<tt>/var/spool/news</tt>.  It is where the mailboxes are stored.
Unlike most netnews systems, Cyrus allows you to have more
than one partition.  Do not use the string "<tt>news</tt>" as a
partition name, as it is reserved for netnews.

 <P>

<li>LINUX SYSTEMS ONLY: Set the configuration, user, quota, and
partition directories to update synchronously.  Failure to do this may
lead to data corruption and/or loss of mail after a system crash.

<pre>
<kbd>   cd /var/imap
   /sbin/chattr +S . user quota
   /sbin/chattr +S /var/spool/imap
</kbd></pre>

Also set the queue directory of the mail daemon to update
synchronously.  The following example is for sendmail:

<pre>
<kbd>   /sbin/chattr +S /var/spool/mqueue
</kbd></pre>

<li>If the Cyrus IMAP server was compiled with Kerberos v4 authentication,
create a Kerberos v4 identity for the server and add the server's key to
the "<tt>srvtab</tt>" file.  The file must be readable by the cyrus
user. The server's Kerberos identity is "<tt>imap.HOST@REALM</tt>",
where "<tt>HOST</tt>" is the first component of the machine's host
name and "<tt>REALM</tt>" is the machine's Kerberos realm.

<p>Here is a sample session, creating a srvtab file for the
host named "<tt>foobar</tt>":

<pre>
<kbd>   ksrvutil -f /var/imap/srvtab add
</kbd></pre>

Here is the information "<tt>ksrvutil</tt>" requests.  Respond by
filling in values or by pressing <KBD>RETURN</KBD>.  In this example,
the host name is "<tt>foobar</tt>" and the realm is 
"<tt>ANDREW.CMU.EDU</tt>".

<pre>
   Name: <kbd>imap</kbd>
   Instance: <KBD>foobar</KBD>
   Realm: <KBD>ANDREW.CMU.EDU</KBD>
   Version number: 
   New principal: imap.foobar@ANDREW.CMU.EDU; version 0
   Is this correct? (y,n) [y] 
   Password: 
   Verifying, please re-enter Password: 
   Key successfully added.
   Would you like to add another key? (y,n) [y] <KBD>n</KBD>
</pre>

If you plan to install Kerberized POP, create the Kerberos
identity "<tt>pop.HOST@REALM</tt>" and add the key to the "<tt>srvtab</tt>"
file.

<P>
Make the "<TT>srvtab</TT>" file owned by the cyrus user:
<pre>
<kbd>   chown cyrus /var/imap/srvtab
</kbd></pre>
<li>Add the following lines to the "<tt>/etc/services</tt>" file if they 
aren't already there.

<pre>
   pop3      110/tcp
   imap      143/tcp
   imsp      406/tcp
   kpop      1109/tcp
</pre>

<li>Add the following line to the "<tt>/etc/inetd.conf</tt>" file.

<pre>
   imap  stream  tcp  nowait  cyrus  /usr/cyrus/bin/imapd  imapd
</pre>

If you want to run the POP3 protocol, add the following line.

<pre>
   pop3  stream  tcp  nowait  cyrus  /usr/cyrus/bin/pop3d  pop3d
</pre>

If you want to run MIT's KPOP (Kerberized POP)
protocol, add the following line

<pre>
   kpop  stream  tcp  nowait  cyrus  /usr/cyrus/bin/pop3d  pop3d -k
</pre>

"<tt>cyrus</tt>" is the Cyrus user and "<tt>/usr/cyrus/bin/</tt>" is the
path name to the executable.

 <P>

<li> Sendmail versions 8.7 and later include support for the Cyrus
IMAP server.  If you are running a verson of Sendmail older than
8.7.1, replace it with 8.7.1 or later.  Sendmail distributions may
be obtained from
<A HREF="ftp://ftp.cs.berkeley.edu/ucb/sendmail">ftp://ftp.cs.berkely.edu/ucb/sendmail</A>

 <P>
<li> Generate a sendmail configuration file which delivers local mail
to the IMAP server.  See the files <TT>cf/README</TT> and
<TT>cf/cf/cyrusproto.mc</TT> in the Sendmail distribution for
information on how to do this.

 <P>
<li>The Cyrus IMAP server support in Sendmail defaults to enabling
duplicate delivery suppression, by invoking the "<TT>deliver</TT>"
program with the "<TT>-e</TT>" switch.
This prevents two messages with the same <TT>Message-ID:</TT>
(<TT>Resent-Message-ID:</TT> if it exits) from being delivered to the
same mailbox.  Add a <TT>cron</TT> job to periodically prune the
database of deliveries by running "<TT>/usr/cyrus/bin/deliver -E
3</TT>" daily as the cyrus user.

</ol>

<h2>Testing the IMAP Server</h2>

To test the IMAP server, reboot and perform the following steps (all
of these samples use "<tt>foobar</tt>" as the IMAP server name):

<ol>

<li>From your normal account, telnet to the IMAP port on the
server you're setting up:

<pre>
<kbd>   telnet foobar imap
</kbd></pre>

If your server is running, you'll get the following message:

<pre>
   Trying 128.2.44.20...
   Connected to foobar.andrew.cmu.edu.
   Escape character is '^]'.
   * OK foobar.andrew.cmu.edu Cyrus IMAP4 v1.4 server ready
</pre>

Any message other than one starting with "<tt>* OK</tt>" means there
is a problem.  To terminate the connection, type "<kbd>. logout</kbd>".

<P>
<li>Use "<tt>imtest</tt>" to test logging in with plaintext passwords.

<pre>
<kbd>   /usr/local/bin/imtest -p foobar imap
</kbd></pre>

If your server is running, you'll get the following message:

<pre>
   * OK foobar.andrew.cmu.edu Cyrus IMAP4 v1.4 server ready
   Password: <var>&lt;enter your password, imtest does not echo it&gt;</var>
   . LOGIN smith X
   . OK User logged in
</pre>

Any message other than one starting with a "<tt>. OK</tt>" means there is
a problem.  If the test fails, a more specific error message is written
through <tt>syslog</tt> to the server log.  To terminate the
connection, type "<kbd>. logout</kbd>".

<P>
<li>If the server is compiled with Kerberos v4 authentication, test
Kerberos authentication by using the imtest command.  Change
to the "<tt>cyrus-v1.4</tt>" directory and type the following:

<pre>
   <kbd>/usr/local/bin/imtest -k foobar imap</kbd>
   * OK foobar.andrew.cmu.edu Cyrus IMAP4 v1.4 server ready
   . AUTHENTICATE KERBEROS_V4
   + Ln8h6Q==
   BAcBQU5EUkVXLkNNVS5FRFUAOCA+0y5YnrqIVikng46sam7RSObZXCVSA9xCx
   BZSGgOy9ehHRj8NQjLjxDpib0D9uT0fo7QaXhLM6zCp9dQ1pX4FfNO2V39vBp
   Q19QIK4S1410prvM2c45qeizecI7zAvA=
   2cRhIC+aH70WHqYaW18YnQ==
   . OK User logged in
   __No integrity protection__
</pre>

Any message other than one starting with a "<tt>. OK</tt>" means there is
a problem. If the test fails, a more specific error message is written
through <TT>syslog</TT> to the server log.  To terminate the
connection, type "<kbd>. logout</kbd>".

</ol>

<h2>Administering Mailboxes</h2>

The "<tt>cyradm</tt>" command (see the <tt>cyradm</tt>(8) man page for
complete documentation) manages the creation of, deletion of, ACLs on,
and quotas on mailboxes.  To get an overview of the command, type
"<kbd>cyradm <var>&lt;host&gt;</var></kbd>".  Once "<tt>cyradm</tt>" has started,
the user prompt is replaced with the name of the host followed by a
"<tt>&gt;</tt>".  Type "<kbd>help</kbd>" at the new prompt.  The
following information is displayed:

<pre>
   createmailbox, cm        create a mailbox
   deleteaclmailbox, dam    delete an ACL on a mailbox
   deletemailbox, dm        delete a mailbox
   help                     get help on commands
   listaclmailbox, lam      list the ACL on a mailbox
   listmailbox, lm          list mailboxes
   listquota, lq            list quota on root
   listquotaroot, lqr, lqm  list quota roots on mailbox
   quit                     exit program
   renamemailbox, renm      rename a mailbox
   setaclmailbox, sam       set an ACL on a mailbox
   setquota, sq             set quota limits
</pre>

<b>Note:</b>If you run "<tt>cyradm</tt>" on a system where Kerberos v4 is
not running, you are prompted for your user name an password before
you can issue any "<tt>cyradm</tt>" commands.

<p>The mailbox naming convention requires that the primary mailbox (inbox)
for anyone must be named "<tt>user.<var>&lt;userid&gt;</var></tt>".
To create a mailbox, type:

<pre>
<kbd>   createmailbox user.<var>&lt;userid&gt;</var>
</kbd></pre>

For example, to create a mailbox for the userid "<tt>smith</tt>", type:

<pre>
<kbd>   createmailbox user.smith
</kbd></pre>

To limit "<tt>smith</tt>" to 10,000 kilobytes of mail, type:

<pre>
<kbd>   setquota user.smith 10000
</kbd></pre>

Once the inbox is created, users can create their own additional mailboxes 
from a mail program.  If Smith created a work mailbox and a play mailbox, 
the full names of the mailboxes would be:

<pre>
   user.smith.work
   user.smith.play
</pre>

<p>Access rights are discussed in detail in the <tt>cyradm</tt>(1) man pages.
Note that the administrator must grant herself delete access
explicitly before she can delete a mailbox:

<pre>
<kbd>   setaclmailbox <var>&lt;mail_box&gt;</var> <var>&lt;admin_userid&gt;</var> d
   deletemailbox <var>&lt;mail_box&gt;</var>
</kbd></pre>

Once you have created mailboxes, your IMAP server installation
is done.  You must then configure a mail interface, such as Pine,
to work with the IMAP server.

<P><HR><P>
<A HREF="index.html">Return</A> to the Cyrus IMAP Server Home Page
</BODY></HTML>
