.\" -*- nroff -*-
.TH RECONSTRUCT 8
.\" Copyright 1996, Carnegie Mellon University.  All Rights Reserved.
.\" 
.\" This software is made available for academic and research
.\" purposes only.  No commercial license is hereby granted.
.\" Copying and other reproduction is authorized only for research,
.\" education, and other non-commercial purposes.  No warranties,
.\" either expressed or implied, are made regarding the operation,
.\" use, or results of the software.  Such a release does not permit
.\" use of the code for commercial purposes or benefits by anyone
.\" without specific, additional permission by the owner of the code.
.SH NAME
reconstruct \- reconstruct mailboxes
.SH SYNOPSIS
.B reconstruct
[
.B \-r
]
.IR mailbox ...
.br
.B reconstruct
.B \-m
.SH DESCRIPTION
.I Reconstruct
rebuilds one or more IMAP mailboxes.  When invoked with the
.B \-m
switch, it rebuilds the master
mailboxes file.  It can be used to recover from
almost any sort of data corruption.
.PP
If
.I Reconstruct
can find existing header and index files, it attempts to preserve any
data in them that is not derivable from the message files themselves.
The state 
.I reconstruct
attempts to preserve includes the flag names, flag state, and
internaldate.
.I Reconstruct
derives all other information from the message files.
.PP
.I Reconstruct
reads its configuration options out of the
.IR imapd.conf (5)
file.  Any mailbox directory underneath the path specified in the
.I partition-news
configuration option is assumed to be in news format.
.PP
.I Reconstruct
does not adjust the quota usage recorded in any quota
root files.  After running
.IR reconstruct ,
it is advisable to run
.IR quota (8)
with the
.I \-f
switch in order to fix the quota root files.
.SH OPTIONS
.TP
.B \-r
Recursively reconstruct all sub-mailboxes of the mailboxes or mailbox
prefixes given as arguments.
.TP
.B \-m
Rebuild the
.I
mailboxes
file.  Use whatever data in the existing
.I mailboxes
file it can scavenge, then scans all partitions listed in the
.IR imapd.conf (5)
file for additional mailboxes.
.SH FILES
.TP
.B /etc/imapd.conf
